### 16，查找employees表
* 如何查找奇数
```
select * from employees
where emp_no % 2 = 1
and last_name != 'Mary'
order by hire_date desc
```

### 17，统计出当前各个title类型对应的员工当前薪水对应的平均工资
* 两个表都得做```to_date='9999-01-01'筛选```

```
Select t.title , Avg(s.salary)
From salaries s Inner Join titles t 
On s.emp_no = t.emp_no 
And s.to_date = '9999-01-01' 
And t.to_date = '9999-01-01'
Group By t.title
```

* [题解](https://how2j.cn/k/gui/gui-panel/406.html#nowhere)


### 18，获取当前薪水第二多的员工的emp_no以及其对应的薪水salary
```
Select emp_no,salary
From salaries
Where to_date = '9999-01-01'
And salary = 
(
	Select Distinct salary
	From salaries
	Order By salary Desc
	Limit 1,1
)

```

### 19，获取当前薪水第二多的员工的emp_no以及其对应的薪水salary，不准使用order by(_)

* 连续用两次Max()聚类函数
```
Select e.emp_no,s.salary,e.last_name,e.first_name
From employees e Inner Join salaries s 
On e.emp_no = s.emp_no
Where s.salary =
(
	Select Max(salary)
	From salaries
	Where salary != 
	(
		Select Max(salary)
		From salaries
	)
)
```

### 20，查找所有员工的last_name和first_name以及对应的dept_name(_)
* 简单连接问题
```
Select e.last_name,e.first_name,d.dept_name
From employees e Left Join dept_emp de 
On e.emp_no = de.emp_no
Left Join departments d
On de.dept_no = d.dept_no
```

### 21，查找员工编号emp_no为10001其自入职以来的薪水salary涨幅值growth(_ _ _)
* （1），
  * 1、先分别找到emp_no=10001的员工的第一次工资记录与最后一次工资记录 
  * 2、再将最后一次工资记录减去第一次工资记录得到入职以来salary的涨幅，最后用别名growth代替 
```
SELECT ( 
(SELECT salary FROM salaries WHERE emp_no = 10001 ORDER BY to_date DESC LIMIT 1) -
(SELECT salary FROM salaries WHERE emp_no = 10001 ORDER BY to_date ASC LIMIT 1)
) AS growth;
```
* （2），
  * 1、直接找到emp_no=10001的员工的工资记录，将其最大工资减去最小工资得到涨幅
```
SELECT (MAX(salary)-MIN(salary)) AS growth 
FROM salaries 
WHERE emp_no = '10001'
```

### 22，查找所有员工自入职以来的薪水涨幅情况

* 1,找到每个员工当前工资
```
Select e.emp_no,s.salary As sNow
From employees As e Inner Join salaries As s 
On e.emp_no = s.emp_no
```

* 2,找出每个员工入职时的工资
```
Select e.emp_no , s.salary As sHire
From employees As e Left Join salaries As s
On e.emp_no = s.emp_no And s.from_date = e.hire_date
```
* 3,结合找出growth
```
Select t1.emp_no ,(t1.sNow-t2.sHire) As growth 
From
(
	Select e.emp_no, s.salary As sNow
  From employees As e Left Join salaries As s 
  On e.emp_no = s.emp_no
  Where s.to_date = '9999-01-01'---注意符号,这个符号不知道是怎么打出来的
) As t1 
Join
(
  Select e.emp_no, s.salary As sHire
  From employees As e Left Join salaries As s
  On e.emp_no = s.emp_no And s.from_date = e.hire_date
) As t2
On t1.emp_no = t2.emp_no
Order By growth Asc;
```

### 23，统计各个部门对应员工涨幅的次数总和(_ _ _ _)

```
Select d.dept_no , d.dept_name , Sum(dS.counts) -- 3，生成部门号，部门名，其中员工涨幅总次数
From departments As d Inner Join (              -- 2,再与部门内联
	Select de.dept_no , de.emp_no , en.counts     -- 1,生成部门编号，部门雇员编号，每个员工所的涨幅次数
	From dept_emp As de Inner Join (
		Select emp_no,Count(emp_no) As counts       -- 0,查询每个员工所的涨幅次数
		From salaries
		Group By emp_no
	)As en
	On de.emp_no = en.emp_no
) As ds
On d.dept_no = ds.dept_no
Group By d.dept_no;
```

### 
















