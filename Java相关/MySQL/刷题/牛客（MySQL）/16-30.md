

### 22，查找所有员工自入职以来的薪水涨幅情况

* 1,找到每个员工当前工资
```
Select e.emp_no,s.salary As sNow
From employees As e Inner Join salaries As s 
On e.emp_no = s.emp_no
```

* 2,找出每个员工入职时的工资
```
Select e.emp_no , s.salary As sHire
From employees As e Left Join salaries As s
On e.emp_no = s.emp_no And s.from_date = e.hire_date
```
* 3,结合找出growth
```
Select t1.emp_no ,(t1.sNow-t2.sHire) As growth 
From
(
	Select e.emp_no, s.salary As sNow
  From employees As e Left Join salaries As s 
  On e.emp_no = s.emp_no
  Where s.to_date = '9999-01-01'---注意符号,这个符号不知道是怎么打出来的
) As t1 
Join
(
  Select e.emp_no, s.salary As sHire
  From employees As e Left Join salaries As s
  On e.emp_no = s.emp_no And s.from_date = e.hire_date
) As t2
On t1.emp_no = t2.emp_no
Order By growth Asc;
```

### 23，统计各个部门对应员工涨幅的次数总和(_ _ _ _)

```
Select d.dept_no , d.dept_name , Sum(dS.counts) -- 3，生成部门号，部门名，其中员工涨幅总次数
From departments As d Inner Join (              -- 2,再与部门内联
	Select de.dept_no , de.emp_no , en.counts     -- 1,生成部门编号，部门雇员编号，每个员工所的涨幅次数
	From dept_emp As de Inner Join (
		Select emp_no,Count(emp_no) As counts       -- 0,查询每个员工所的涨幅次数
		From salaries
		Group By emp_no
	)As en
	On de.emp_no = en.emp_no
) As ds
On d.dept_no = ds.dept_no
Group By d.dept_no;
```

### 
















